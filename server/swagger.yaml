---
swagger: '2.0'
info:
  version: 0.0.1
  title: "@Apple_pie server API doc list"
  description: |
    last update: 31/12/2020 00:06
    все API сервера начинаются с /api роута
tags:
- name: sign
  description: Аутентификация
- name: auth
  description: Авторизация
- name: customer
  description: Для потребителя
- name: artist
  description: Для тату мастера
- name: user
  description: Общие данные о пользователях
paths:
  "/sign/up":
    post:
      tags:
      - sign
      summary: регистрация
      parameters:
      - name: email
        in: body
        description: user email
        required: true
        type: string
      - name: password
        in: body
        description: user password
        required: true
        type: string
      - name: role
        in: body
        description: user role
        required: true
        schema:
          type: number
          enum:
          - 1
          - 2
      responses:
        '201':
          description: created
          schema:
            type: object
            properties:
              accessToken:
                type: string
        '406':
          description: Неверный формат поля
          schema:
            type: object
            properties:
              field:
                type: string
        '409':
          description: Конфликт существующих данных
          schema:
            type: object
            properties:
              field:
                type: string
  "/sign/in":
    post:
      tags:
      - sign
      summary: log in
      parameters:
      - name: email
        in: body
        description: user email
        required: true
        type: string
      - name: password
        in: body
        description: user password
        required: true
        type: string
      responses:
        '200':
          description: OK
          schema:
            type: object
            properties:
              accessToken:
                type: string
        '406':
          description: Неверныe данные
  "/sign/out":
    get:
      tags:
      - sign
      summary: log out
      responses:
        '200':
          description: OK
  "/auth/refresh":
    get:
      tags:
      - auth
      summary: получить новый access и refresh токены
      responses:
        '201':
          description: created
          schema:
            type: object
            properties:
              accessToken:
                type: string
        '406':
          description: Просроченный или отсутствующий refresh токен
  "/customer/applist":
    get:
      tags:
      - customer
      summary: получить список всех заявок потребителя
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              "$ref": "#/definitions/Application"
        '403':
          description: Неверная роль
  "/customer/application":
    post:
      tags:
      - customer
      summary: создать заявку
      consumes:
      - multipart/form-data
      parameters:
      - name: title
        in: formData
        description: application title
        required: true
        type: string
      - name: descr
        in: formData
        description: application description
        required: true
        type: string
      - name: images
        in: formData
        required: true
        type: array
        items:
          type: file
      responses:
        '201':
          description: Created
        '403':
          description: Неверная роль
  "/artist/sketchlist":
    get:
      tags:
      - artist
      summary: получить все эскизы тату мастера
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              "$ref": "#/definitions/Sketch"
        '403':
          description: Неверная роль
  "/user/profile":
    get:
      tags:
      - user
      summary: получить все данные авторизированого пользователя
      responses:
        '200':
          schema:
            $ref: "#/definitions/User"
  "/user/exist":
    post:
      tags:
      - user
      summary: проверить существуют ли такие данные в DB
      parameters:
      - name: name
        in: query
        description: check if name is existed in DB
        type: string
      - name: email
        in: query
        description: check if email is existed in DB
        type: string
      responses:
        '200':
          schema:
            type: object
            properties:
              exists:
                type: boolean
definitions:
  User:
    type: object
    properties:
      id:
        type: string
        description: string in uuid format
        required: true
      name:
        type: string
        required: true
      email:
        type: string
        required: true
      password:
        type: string
        description: encrypted
        required: true
      role:
        type: number
        enum:
        - 1
        - 2
        required: true
      created_at:
        type: number
        description: user create date
        required: true
      applications:
        type: array
        items:
          $ref: "#/definitions/Application"
        description: array of application's id
        default: []
      sketches:
        type: array
        items:
          $ref: "#/definitions/Sketch"
        description: array of sketches's id
        default: []
  Application:
    type: object
    properties:
      id:
        type: string
        description: string id in uuid format
        required: true
      author:
        type: string
        description: user id
        required: true
      title:
        type: string
        required: true
      descr:
        type: string
        required: true
      images:
        type: array
        items:
          type: string
          description: image path
        required: true
      created_at:
        type: string
        required: true
  Sketch:
    type: object
    properties:
      id:
        type: string
        description: string id in uuid format
        required: true
      author:
        type: string
        description: user id
        required: true
      title:
        type: string
        required: true
      descr:
        type: string
        required: true
      images:
        type: array
        items:
          type: string
          description: image path
        required: true
      created_at:
        type: string
        required: true
  Session:
    type: object
    properties:
      userId:
        type: String
      refreshToken:
        type: String
      ua:
        type: String
        description: browser user agent
      fingerprint:
        type: String
      ip:
        type: String
      createAt:
        type: String
